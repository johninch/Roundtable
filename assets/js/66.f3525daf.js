(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{507:function(t,s,a){t.exports=a.p+"assets/img/Object.prototype.toString.call.a10aabff.png"},815:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[t._v("本文是在 ConardLi的“"),e("a",{attrs:{href:"https://juejin.im/post/5cec1bcff265da1b8f1aa08f",target:"_blank",rel:"noopener noreferrer"}},[t._v("【JS 进阶】你真的掌握变量和类型了吗"),e("OutboundLink")],1),t._v("”文章上的总结和扩展，集中记述了js中的变量和数据类型的相关知识点及应用场景，共分为5部分。")])]),t._v(" "),e("blockquote",[e("p",[t._v("本文为“JS专题-变量与类型”的第5篇，5）JS的类型判断方法，推荐使用 "),e("code",[t._v("typeof")]),t._v("、"),e("code",[t._v("Object.prototype.toString.call()")]),t._v("，不要用"),e("code",[t._v("instanceof")]),t._v("。")])]),t._v(" "),e("h1",{attrs:{id:"js的类型判断方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#js的类型判断方法"}},[t._v("#")]),t._v(" JS的类型判断方法")]),t._v(" "),e("p",[t._v("推荐使用 "),e("code",[t._v("typeof")]),t._v("、"),e("code",[t._v("Object.prototype.toString.call()")]),t._v("，不要用"),e("code",[t._v("instanceof")]),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"typeof"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#typeof"}},[t._v("#")]),t._v(" typeof")]),t._v(" "),e("p",[e("strong",[t._v("typeof可以用来准确判断")])]),t._v(" "),e("ul",[e("li",[t._v("除"),e("code",[t._v("null以外的原始类型")])]),t._v(" "),e("li",[t._v("以及"),e("code",[t._v("function")]),t._v("这种引用类型")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ConardLi'")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// string")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// number")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// boolean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Symbol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// symbol")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// function")]),t._v("\n")])])]),e("p",[e("strong",[t._v("typeof不适用于判断")])]),t._v(" "),e("ul",[e("li",[t._v("大部分引用类型（除了上面的function类型）")]),t._v(" "),e("li",[t._v("原始类型 null")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v("\\d"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("$"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// object")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// object  初版Js就留下来的bug")]),t._v("\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("null不是一个对象，但为什么typeof null === object?")]),t._v(" "),e("p",[t._v("原理是这样的，不同的对象在底层都会表示为二进制，在"),e("code",[t._v("js中如果二进制的前三位都为0")]),t._v("，就会被判断为"),e("strong",[t._v("object类型")]),t._v("，"),e("code",[t._v("null的二进制全为0")]),t._v("，自然前三位也是0，所以typeof null === objcet。")])]),t._v(" "),e("h2",{attrs:{id:"instanceof"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#instanceof"}},[t._v("#")]),t._v(" instanceof")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("首先要明确一点的是："),e("strong",[t._v("使用instanceof来检测数据类型不是它的设计初衷")]),t._v("，它"),e("code",[t._v("不能检测原始数据类型")]),t._v("，且"),e("code",[t._v("对于引用类型的判断也不准确")]),t._v("。")])]),t._v(" "),e("p",[t._v("它可以判断一些引用类型，原理是通过原型链：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RegExp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RegExp")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])])]),e("p",[t._v("简单回顾下原型链的规则：")]),t._v(" "),e("ul",[e("li",[t._v("1."),e("code",[t._v("所有引用类型都具有对象特性")]),t._v("，即可以自由扩展属性")]),t._v(" "),e("li",[t._v("2.所有引用类型都具有一个"),e("code",[t._v("__proto__（隐式原型）")]),t._v("属性，是一个普通对象")]),t._v(" "),e("li",[t._v("3.所有的"),e("strong",[t._v("函数")]),t._v("都具有"),e("code",[t._v("prototype（显式原型）")]),t._v("属性，也是一个普通对象")]),t._v(" "),e("li",[t._v("4.所有引用类型"),e("code",[t._v("__proto__")]),t._v("值指向它构造函数的"),e("code",[t._v("prototype")])]),t._v(" "),e("li",[t._v("5.当试图得到一个对象的属性时，如果变量本身没有这个属性，则会去他的"),e("code",[t._v("__proto__")]),t._v("中去找")])]),t._v(" "),e("p",[e("code",[t._v("[] instanceof Array")]),t._v("是用来判断 对象[] 是否是构造函数 Array 的实例。其原理是根据 实例对象[] 的__proto__属性 与 构造函数 Array 的prototype属性 "),e("code",[t._v("是否引用的是同一个原型对象地址来判断")]),t._v("的。")]),t._v(" "),e("p",[e("code",[t._v("[] instanceof Array")]),t._v("实际上是判断"),e("code",[t._v("Array.prototype")]),t._v("是否在"),e("code",[t._v("[]")]),t._v("的原型链上，但在这条原型链上的构造函数都是实例对象的构造函数，因此通过原型来判断就会造成误差：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("顺便想一下：怎样判断一个实例对象的直接构造函数是谁呢？")]),t._v(" "),e("blockquote",[e("p",[t._v("只能通过原型对象的constructor属性来判断是否："),e("code",[t._v("o.__proto__.constructor === M")])]),t._v(" "),e("blockquote",[e("p",[t._v("注意：o."),e("strong",[t._v("proto")]),t._v(".constructor与o.constructor是一样的，其实本质就是通过原型链找到constructor属性。")])])])]),t._v(" "),e("h2",{attrs:{id:"tostring"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tostring"}},[t._v("#")]),t._v(" toString")]),t._v(" "),e("ul",[e("li",[t._v("在拆箱操作中提到了toString函数，我们可以调用它实现从引用类型的转换。")]),t._v(" "),e("li",[t._v("每一个引用类型都有toString方法，默认情况下，toString()方法被每个Object对象继承。"),e("code",[t._v("如果此方法在自定义对象中未被覆盖")]),t._v("，toString() 返回 "),e("strong",[t._v('"[object type]"')]),t._v("，其中type是对象的类型。")]),t._v(" "),e("li",[t._v("上面提到了"),e("code",[t._v("如果此方法在自定义对象中未被覆盖")]),t._v("，toString才会达到预想的效果，事实上，大部分引用类型比如"),e("code",[t._v("Array、Date、RegExp")]),t._v("等"),e("strong",[t._v("都重写了toString方法")]),t._v("。")]),t._v(" "),e("li",[t._v("我们可以直接调用Object原型上未被覆盖的toString()方法，使用"),e("code",[t._v("call来改变this")]),t._v("指向来达到我们想要的效果。")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(507),alt:"Object.prototype.toString.call()"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);