# SSR 服务端渲染和同构原理

## 为什么要服务端渲染（SSR）

- **首屏等待**：在 SPA 模式下，所有的数据请求和 Dom 渲染都在浏览器端完成，所以当我们第一次访问页面的时候很可能会存在“白屏”等待，而服务端渲染所有数据请求和 html内容已在服务端处理完成，浏览器收到的是完整的 html 内容，可以更快的看到渲染内容，在服务端完成数据请求肯定是要比在浏览器端效率要高的多。
- **更好支持SEO**：有些网站的流量来源主要还是靠搜索引擎，所以网站的 SEO 还是很重要的，而 SPA 模式对搜索引擎不够友好，要想彻底解决这个问题只能采用服务端直出。改变不了别人（搜索yinqing），只能改变自己。

## 传统SSR

传统的SSR服务端渲染，是指**服务端直接吐出具有数据的HTML页面，而不是在客户端拼接的HTML**。单纯实现SSR是很传统的技术，很简单，不分语言，随便用 php 、jsp、asp、node 等都可以实现。

而现今流行的SPA单页应用，则是CSR客户端渲染，指的是在客户端通过Ajax请求来拼装数据，所有页面都是在客户端拼接好的。

如果只实现 SSR 其实没意义，技术上没有任何发展和进步，否则 SPA 技术就不会出现。

## 前端同构应用（SSR + SPA）

**最好的方案是**：`SSR + SPA 的前端同构应用`。第一次访问页面是服务端渲染，基于第一次访问，后续的交互就是 SPA 的效果和体验，还不影响SEO。简单说就是一个前端项目里的组件，部分服务端渲染后输出，部分由客户端异步渲染，既保障网页渲染速度，也有利于搜索引擎 SEO。

**「同构」**的意思是：服务端和前端使用同一套渲染层代码，在服务端执行虚拟DOM(一般用Node.js)，此时服务端使用和前端相同的虚拟DOM的原理来拼接HTML模板。

得益于 Node.js 既是后端又是用JS来写，使得使用一套代码就能在服务端和客户端都执行渲染，最大限度的重用代码（同构），减少开发维护成本。当前的前端同构应用，需要采用 react 或者 vue 等前端框架，与 node SSR 结合来实现。







