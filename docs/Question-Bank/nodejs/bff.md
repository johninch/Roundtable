# BFF

## 什么是 BFF

服务端接口设计是：面向 UI or 通用服务？没有对错，不同视角看到的问题不一样。

BFF 层一直都存在，区别只是在于维护者是谁。

## 为什么需要 BFF

如果 UI 直接调用底层服务（领域服务或基础服务），会造成领域服务或基础服务无法稳定，经常需要跟随 UI 变动。所以每个前端必须有 BFF 层，这是条红线。BFF 存在的目的，除了快速响应前端迭代外，还有一个目的是为了隔离前端后端，让后端更稳定，有沉淀。

## BFF 应该由谁维护

前端到后端的适配层是非常 dirty 的一层代码，经常要加入各种特殊处理，使用脚本开发成本低。并且这一层由于基本上就是做各种对象到对象的翻译，不太会出现难以排查的错误，就算有这样的错误，强类型语言对避免这种错误也没什么帮助。同时，这一层属于典型的无状态 IO 密集型模块，非常适合吞吐能力巨大的 node.js 开发，用 java 开发也不会带来什么额外的性能优势。前端对这一层的变动需求，要比后端多得多，本着“谁用谁维护，谁爽谁负责”的原则，这一层应该由前端维护，使用 node.js 编写这一层对前端来说更友好。

本着谁使用谁负责的原则，前端是业务方，是需求方，应该承担起一个串联多个后端团队提供的领域能力的职责是更合适的，将接口的编排从后端解耦出来，需求和提供完全由前端来完成，就省去了协作成本，对于专注于服务下沉的后端来说，是完全无感的。

而有同学认为，bff 层的维护方需要清楚知道后端具体有哪些能力，哪些领域接口字段，而后端比前端更了解一些，所以应该由后端同学维护。这一点上，其实无论前端还是后端作为维护者，都会遇到这个问题。领域能力后端必须要将自己的接口字段清楚地提供给 bff 的维护者，后端维护并不比前端维护更占优势。

bff 层适用于比如首页场景，需要聚合很多很多领域接口，作为中间层串联。

前端接管 BFF 层后，后端可以安心做微服务化，胶水层前端自己做本来是好事；但是小公司需求多，前端人员活变多了，但是效率/人力还是没提上去，加上本身页面和 gateway 的技术差异，对于前端同学有一定学习运用成本，还是有点略尴尬。

目前的发展趋势是前端全干化，后端向云和基础服务下沉

后端云服务化，与业务解耦，更专注于基础设施建设、性能方向

服务中台，主要好处就是后端的接口更具有通用性，可以同时给多个业务线提供服务，避免了大公司每个业务线自行开发自己服务的弊端

## nodejs 做 BFF 后所导致的延时问题

撑死 50ms，在某些不是 toC 的大数据量场景下，其实是完全可以接受的。。。并且在阿里，对于 bff 层，会做些预渲染，ssr 的功能，所以 bff 就不只是一个数据聚合的胶水层那么简单



BFF（Backend for Frontend）层，主要就是就是为了前端服务的后端。与其说是后端，不如说是各种端（Browser、APP、miniprogram）和后端各种微服务、API之间的一层胶水代码。这层代码主要的业务场景也比较集中，大多数是请求转发、数据组织、接口适配、权鉴和SSR。在这种业务场景下，采用大前端的开发模式，会提升业务的迭代效率。1、前端和后端都使用JavasScript，技术栈是统一的。从写代码，到编译、打包、脚手架、组件化、包管理，再到CICD，采用同一套都不是问题。2、Client Side JavaScript和Server Side JavaScript本身就有很多可服用的代码，例如现在行业里有很多同构代码的CSR和SSR解决方案。3、优化研发组织结构。大前端的开发模式，让接口定义、接口联调、环境模拟等，原来需要两种不同技术能力栈的工程师互相协作的模式，变为同一种技术技术能力栈的工程师独立完成的模式，让沟通和推动的成本降到最低。

作者：imjens
链接：https://www.zhihu.com/question/354546765/answer/905162989
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。